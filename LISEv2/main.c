#include <unistd.h>
#include <sys/wait.h>
#include <stdio.h>
#include <stdlib.h>

#include <sys/stat.h>
#include <string.h>

#include "./src/lise.h"

const float ot = 2.7; //occupied grid threshold
const float st = 5.5; //sphere threshold
const float ast = 4;  //score assignment threshold
const float sat = 0.1; //0.025;//0? //surface area threshould
const float Eft = 1;
const float w = 2;
const float bw2 = 8.25; //two sphere overlap threshold
const float MIN = 1000;
const float MAX = -1000;

float Fb[14][14][14] =
	{ {{   0.932,   0.349,   1.282,   0.603,   1.586,   0.000,   0.916,   1.419,   0.608,   0.723,   0.563,   1.594,   1.002,   0.892},
		{   0.000,   0.271,   0.529,   0.471,   0.812,   0.000,   0.621,   1.051,   0.259,   0.459,   0.353,   0.586,   0.413,   0.467},
		{   0.000,   0.000,   1.916,   0.880,   2.384,   0.000,   1.428,   2.728,   0.958,   1.251,   0.955,   2.490,   1.543,   1.218},
		{   0.000,   0.000,   0.000,   1.528,   2.187,   0.000,   1.020,   1.684,   0.322,   1.302,   0.498,   1.334,   1.073,   1.075},
		{   0.000,   0.000,   0.000,   0.000,   6.576,   0.000,   2.343,   3.847,   0.944,   3.010,   1.161,   3.658,   2.386,   2.682},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.119,   2.617,   0.606,   1.313,   0.897,   1.827,   1.061,   1.427},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   6.190,   1.137,   2.167,   1.418,   4.302,   1.233,   1.862},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.675,   0.447,   0.542,   1.243,   0.876,   0.814},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.987,   0.590,   1.604,   1.178,   1.978},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.651,   1.034,   0.587,   0.696},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.999,   2.234,   1.174},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.266,   2.025},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.192}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.363,   0.417,   0.659,   0.783,   0.000,   0.710,   1.401,   0.226,   0.613,   0.362,   0.410,   0.486,   0.534},
		{   0.000,   0.000,   0.888,   0.742,   1.469,   0.000,   1.079,   2.224,   0.425,   0.950,   0.629,   1.053,   0.885,   0.705},
		{   0.000,   0.000,   0.000,   2.558,   2.633,   0.000,   1.607,   2.595,   0.319,   2.141,   0.566,   1.365,   1.438,   1.357},
		{   0.000,   0.000,   0.000,   0.000,   6.240,   0.000,   2.684,   4.541,   0.590,   3.520,   0.984,   2.745,   2.499,   2.047},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.594,   4.228,   0.506,   1.880,   1.009,   1.412,   1.206,   1.405},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   8.153,   0.849,   3.161,   1.542,   3.035,   1.807,   2.153},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.322,   0.358,   0.400,   0.533,   0.434,   0.417},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.004,   0.661,   1.487,   1.716,   1.785},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.593,   0.615,   0.440,   0.549},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.857,   1.264,   0.789},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.968,   1.209},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.401}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   3.124,   1.568,   4.450,   0.000,   2.524,   5.550,   1.483,   2.678,   1.728,   4.297,   2.856,   1.855},
		{   0.000,   0.000,   0.000,   2.994,   4.874,   0.000,   2.299,   4.108,   0.535,   3.434,   0.912,   2.831,   2.787,   1.716},
		{   0.000,   0.000,   0.000,   0.000,  15.014,   0.000,   5.505,  10.782,   1.565,   7.962,   2.289,   7.704,   6.759,   4.184},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.355,   6.179,   1.001,   3.431,   1.732,   3.557,   2.542,   2.288},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  16.222,   2.240,   7.109,   3.105,   9.060,   3.886,   3.908},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.027,   0.865,   0.956,   2.104,   1.359,   1.203},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   5.885,   1.355,   4.022,   4.395,   3.034},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.304,   1.949,   1.239,   1.151},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   7.170,   4.332,   2.150},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   5.664,   3.178},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.762}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,  16.868,  16.513,   0.000,   8.568,  10.433,   0.923,  15.830,   1.894,   9.249,   9.017,   5.255},
		{   0.000,   0.000,   0.000,   0.000,  26.169,   0.000,   9.964,  15.619,   1.290,  16.061,   2.405,  12.107,  15.843,   6.462},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   4.558,   9.402,   0.736,   8.072,   1.752,   4.681,   5.701,   4.130},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  17.500,   0.997,  11.733,   2.205,   9.443,   7.066,   5.422},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.304,   0.805,   0.422,   0.889,   0.833,   0.693},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  13.400,   1.601,   7.604,  12.117,   5.790},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.720,   1.316,   1.001,   1.022},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   7.219,   6.847,   2.857},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  10.727,   5.037},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.703}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,  61.859,   0.000,  26.223,  44.346,   4.448,  31.679,   7.348,  29.769,  38.143,  16.837},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   8.289,  19.191,   1.651,  13.995,   3.766,  10.795,  11.733,   7.871},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  47.188,   2.701,  23.044,   4.999,  23.479,  16.962,  11.177},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.879,   2.110,   1.069,   2.775,   1.913,   1.584},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  19.683,   3.526,  14.841,  23.528,  10.658},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.764,   3.266,   2.397,   2.118},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  16.119,  13.745,   7.292},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  25.811,   7.414},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  10.364}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000, 381.065, 124.129, 522.937,  48.348, 276.264,  56.792, 200.278, 407.962,  51.274},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  32.943,  75.099,   8.419,  37.979,  15.650,  46.263,  52.688,  20.514},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000, 305.794,  50.274,  99.607,  47.696, 162.163, 125.579,  28.886},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  19.375,  10.293,  12.386,  44.459,  12.553,   6.613},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000, 111.360,  15.033,  54.131, 121.574,  40.848},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   7.953,  21.879,  16.723,   7.443},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000, 102.767,  58.737,  26.254},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000, 154.065,  39.860},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  32.222}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.400,   9.320,   0.934,   5.456,   2.254,   3.609,   3.738,   3.701},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  24.593,   1.932,  13.816,   4.388,   9.826,   5.757,   8.079},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.563,   0.948,   0.881,   1.492,   0.904,   1.281},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  10.618,   2.298,   5.456,   7.771,   5.914},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.674,   2.100,   1.355,   1.968},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   6.623,   4.250,   2.956},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   6.784,   3.425},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.427}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  70.602,   4.888,  32.820,   9.824,  29.586,  13.316,  15.676},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.121,   1.552,   1.428,   3.901,   1.056,   1.483},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  16.698,   3.447,  13.737,  11.149,   7.048},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.472,   3.968,   1.486,   2.011},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  18.552,   7.961,   6.024},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   8.674,   4.780},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.995}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.109,   0.474,   0.858,   1.459,   1.458,   1.511},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.711,   0.608,   1.421,   1.100,   1.137},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.880,   1.150,   0.814,   0.920},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.590,   2.201,   1.185},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.386,   3.313},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.670}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  17.336,   2.510,  10.181,  18.050,   8.173},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.057,   1.576,   1.428,   1.654},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   7.465,   8.098,   5.020},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  19.859,   5.140},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   9.499}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.201,   1.291,   0.707,   0.867},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.929,   1.497,   1.032},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.959,   1.730},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   1.105}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  13.829,   8.286,   3.526},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  10.756,   4.812},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   2.191}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,  16.982,   9.258},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.688}},
		{{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000},
		{   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   0.000,   3.428}} };

void checkinput(int n);

int main(int argc, char *argv[]) {
        
    char pdb_id[5];
    IPRO ipro;
    ILIG ilig;

    char path[100];
    FILE *ipro_file, *ilig_file;
    int nof_ipro, nof_ilig;

    createipro(0, &ipro);
    createilig(0, &ilig);
    //get PDB ID
    checkinput(fscanf(stdin, "PDB_ID: %s\n", &pdb_id));
    //get path to ipro file
    checkinput(fscanf(stdin, "IPRO_PATH: %s\n", path));
    ipro_file = fopen(path, "r");
    //get path to ilig file
    checkinput(fscanf(stdin, "ILIG_PATH: %s\n", path));
    ilig_file = fopen(path, "r");

    setipro(ipro_file, &ipro);
    setilig(ilig_file, &ilig);

    checkinput(fscanf(stdin, "IPRO_ATOMS: %d\n", &nof_ipro));
    checkinput(fscanf(stdin, "ILIG_ATOMS: %d\n", &nof_ilig));

    fclose(ipro_file);
    fclose(ilig_file);

    if (nof_ipro != ipro.numAtoms) {
        fprintf(stderr, "Error: Descrepancy with ipro atoms\n");
        desipro(&ipro);
        desilig(&ilig);
        exit(2);
    } /*else if (nof_ilig != ilig.numAtoms) {
        fprintf(stderr, "Error: Descrepancy with ipro atoms\n");
        desipro(&ipro);
        desilig(&ilig);
        exit(2);
    }*/

    if (ipro.numAtoms == 0) {
        fprintf(stdin, "No ipro atoms found.\n");
        desipro(&ipro);
        desilig(&ilig);
        exit(1);
    } else if (ilig.numAtoms == 0) {
        desilig(&ilig);
    }

    fprintf(stdout, "Protiens set.\n");

    IPRO_STATS ipro_st;
    GRID grid;

    createiprostats(nof_ipro, &ipro_st);
    setiprostats(&ipro, &ipro_st);
    fprintf(stdout, "Ipro stats set.\n");
    creategrid(&ipro_st, &grid);
    setgridocc(&ipro, &ipro_st, &grid);
    fprintf(stdout, "Grid occupied.\n");
    setgridscore(&ipro, &ipro_st, &grid);
    fprintf(stdout, "Grid scores computed.\n");
    setgridloc(&grid);
    setgridSscore(&ipro_st, &grid);
    fprintf(stdout, "Sphere scores computed.\n");
    /*
    desgrid(&ipro_st, &grid);
    desiprostats(nof_ipro, &ipro_st);

    desipro(&ipro);
    if (nof_ilig > 0) {
        desilig(&ilig);
    }
    */
    exit(1);
}

void checkinput(int n) {
    if (n == 0 || n == EOF) {
        exit(2);
    }
}
